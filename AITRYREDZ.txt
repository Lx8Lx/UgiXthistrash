-- UgiX UI Library (محدثة ومطورة) --

local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local Configs_HUB = {
  Cor_Hub = Color3.fromRGB(15, 15, 15),
  Cor_Options = Color3.fromRGB(20, 20, 20),
  Cor_Stroke = Color3.fromRGB(92, 64, 51),
  Cor_Text = Color3.fromRGB(180, 180, 180),
  Cor_DarkText = Color3.fromRGB(240, 240, 240),
  Corner_Radius = UDim.new(0, 6),
  Text_Font = Enum.Font.FredokaOne
}

local function Create(instance, parent, props)
  local new = Instance.new(instance)
  new.Parent = parent
  if props then
    for prop, value in pairs(props) do
      new[prop] = value
    end
  end
  return new
end

local function Corner(parent)
  local c = Create("UICorner", parent)
  c.CornerRadius = Configs_HUB.Corner_Radius
  return c
end

local function Stroke(parent)
  local s = Create("UIStroke", parent)
  s.Color = Configs_HUB.Cor_Stroke
  s.ApplyStrokeMode = "Border"
  return s
end

local function Tween(instance, prop, value, time)
  local tw = TweenService:Create(instance, TweenInfo.new(time or 0.3, Enum.EasingStyle.Quad), {[prop] = value})
  tw:Play()
  return tw
end

local ScreenGui = CoreGui:FindFirstChild("UgiX_UI")
if ScreenGui then ScreenGui:Destroy() end
ScreenGui = Create("ScreenGui", CoreGui)
ScreenGui.Name = "UgiX_UI"

local Window = Create("Frame", ScreenGui, {
  Size = UDim2.new(0, 600, 0, 380),
  Position = UDim2.new(0.5, -300, 0.5, -190),
  BackgroundColor3 = Configs_HUB.Cor_Hub,
  Active = true,
  Draggable = true
})
Corner(Window)
Stroke(Window)

-- Top Bar
local TopBar = Create("Frame", Window, {
  Size = UDim2.new(1, 0, 0, 30),
  BackgroundColor3 = Configs_HUB.Cor_Options
})
Corner(TopBar)
Stroke(TopBar)

local TitleLabel = Create("TextLabel", TopBar, {
  Text = "UgiX - المطور",
  Font = Configs_HUB.Text_Font,
  TextSize = 20,
  TextColor3 = Configs_HUB.Cor_DarkText,
  BackgroundTransparency = 1,
  Size = UDim2.new(1, -90, 1, 0),
  Position = UDim2.new(0, 10, 0, 0),
  TextXAlignment = Enum.TextXAlignment.Left,
  TextYAlignment = Enum.TextYAlignment.Center
})

-- Close Button
local CloseBtn = Create("TextButton", TopBar, {
  Text = "×",
  Font = Configs_HUB.Text_Font,
  TextSize = 25,
  TextColor3 = Color3.fromRGB(240, 60, 60),
  BackgroundTransparency = 1,
  Size = UDim2.new(0, 40, 1, 0),
  Position = UDim2.new(1, -45, 0, 0),
  AutoButtonColor = false
})
Corner(CloseBtn)

CloseBtn.MouseButton1Click:Connect(function()
  Tween(Window, "Size", UDim2.new(0, 0, 0, 0), 0.3).Completed:Wait()
  ScreenGui:Destroy()
end)

-- Minimize Button (أعلى اليسار)
local MinBtn = Create("ImageButton", TopBar, {
  Image = "rbxassetid://116612960959791",
  Size = UDim2.new(0, 35, 0, 25),
  Position = UDim2.new(1, -90, 0, 2),
  BackgroundColor3 = Configs_HUB.Cor_Options,
  AutoButtonColor = true
})
Corner(MinBtn)
Stroke(MinBtn)

local minimized = false
MinBtn.MouseButton1Click:Connect(function()
  minimized = not minimized
  if minimized then
    Tween(Window, "Size", UDim2.new(0, 0, 0, 0), 0.25)
  else
    Tween(Window, "Size", UDim2.new(0, 600, 0, 380), 0.25)
  end
  wait(0.3)
  Window.Visible = not minimized
end)

-- Tabs Container (على اليسار)
local TabsContainer = Create("Frame", Window, {
  Size = UDim2.new(0, 140, 1, -40),
  Position = UDim2.new(0, 10, 0, 35),
  BackgroundColor3 = Configs_HUB.Cor_Options,
})
Corner(TabsContainer)
Stroke(TabsContainer)

local TabsLayout = Create("UIListLayout", TabsContainer)
TabsLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabsLayout.Padding = UDim.new(0, 5)

-- Content Container (يمين التبويبات)
local ContentContainer = Create("Frame", Window, {
  Size = UDim2.new(1, -160, 1, -40),
  Position = UDim2.new(0, 160, 0, 35),
  BackgroundColor3 = Configs_HUB.Cor_Options,
})
Corner(ContentContainer)
Stroke(ContentContainer)

-- لجمع التبويبات والمحتويات
local tabs = {}
local contents = {}

local function ClearContents()
  for _, frame in pairs(contents) do
    frame.Visible = false
  end
end

local function ActivateTab(index)
  for i, tabBtn in ipairs(tabs) do
    if i == index then
      tabBtn.BackgroundColor3 = Color3.fromRGB(92, 64, 51)
      tabBtn.TextColor3 = Configs_HUB.Cor_DarkText
      contents[i].Visible = true
    else
      tabBtn.BackgroundColor3 = Configs_HUB.Cor_Options
      tabBtn.TextColor3 = Configs_HUB.Cor_Text
      contents[i].Visible = false
    end
  end
end

local function MakeTab(name)
  local tabBtn = Create("TextButton", TabsContainer, {
    Text = name,
    Font = Configs_HUB.Text_Font,
    TextSize = 18,
    TextColor3 = Configs_HUB.Cor_Text,
    BackgroundColor3 = Configs_HUB.Cor_Options,
    Size = UDim2.new(1, 0, 0, 40),
    AutoButtonColor = true
  })
  Corner(tabBtn)
  Stroke(tabBtn)

  local contentFrame = Create("ScrollingFrame", ContentContainer, {
    Size = UDim2.new(1, -10, 1, -10),
    Position = UDim2.new(0, 5, 0, 5),
    BackgroundTransparency = 1,
    ScrollBarThickness = 6,
    CanvasSize = UDim2.new(0, 0, 0, 0),
    AutomaticCanvasSize = Enum.AutomaticSize.Y,
    VerticalScrollBarInset = Enum.ScrollBarInset.Always,
    Visible = false
  })

  local layout = Create("UIListLayout", contentFrame)
  layout.Padding = UDim.new(0, 8)
  layout.SortOrder = Enum.SortOrder.LayoutOrder

  table.insert(tabs, tabBtn)
  table.insert(contents, contentFrame)

  tabBtn.MouseButton1Click:Connect(function()
    ActivateTab(#tabs)
  end)

  -- إذا هذا أول تبويب، نشغله تلقائياً
  if #tabs == 1 then
    ActivateTab(1)
  end

  return contentFrame
end

-- دوال لإضافة العناصر داخل التبويب --

local function AddParagraph(parent, texts)
  local frame = Create("Frame", parent, {
    BackgroundColor3 = Configs_HUB.Cor_Hub,
    Size = UDim2.new(1, 0, 0, 70),
  })
  Corner(frame)

  local title = Create("TextLabel", frame, {
    Text = texts[1] or "ملاحظة",
    Font = Configs_HUB.Text_Font,
    TextSize = 20,
    TextColor3 = Configs_HUB.Cor_DarkText,
    BackgroundTransparency = 1,
    Position = UDim2.new(0, 12, 0, 6),
    Size = UDim2.new(1, -24, 0, 30),
    TextXAlignment = Enum.TextXAlignment.Left
  })

  local content = Create("TextLabel", frame, {
    Text = texts[2] or "",
    Font = Enum.Font.Arial,
    TextSize = 16,
    TextColor3 = Configs_HUB.Cor_Text,
    BackgroundTransparency = 1,
    Position = UDim2.new(0, 12, 0, 36),
    Size = UDim2.new(1, -24, 0, 30),
    TextXAlignment = Enum.TextXAlignment.Left,
    TextWrapped = true
  })

  return frame
end

local function AddDiscord(parent, data)
  local frame = Create("Frame", parent, {
    BackgroundColor3 = Configs_HUB.Cor_Hub,
    Size = UDim2.new(1, 0, 0, 70)
  })
  Corner(frame)

  local icon = Create("ImageLabel", frame, {
    Image = data.DiscordIcon or "",
    Size = UDim2.new(0, 50, 0, 50),
    Position = UDim2.new(0, 10, 0, 10),
    BackgroundTransparency = 1,
    ScaleType = Enum.ScaleType.Fit
  })

  local btn = Create("TextButton", frame, {
    Text = data.DiscordTitle or "انضم لديسكوردنا",
    Font = Configs_HUB.Text_Font,
    TextSize = 18,
    TextColor3 = Color3.fromRGB(100, 220, 255),
    BackgroundTransparency = 1,
    Position = UDim2.new(0, 70, 0, 15),
    Size = UDim2.new(1, -80, 0, 40),
    AutoButtonColor = true,
    TextXAlignment = Enum.TextXAlignment.Left
  })
  Corner(btn)

  btn.MouseButton1Click:Connect(function()
    local success, err = pcall(function()
      if setclipboard then
        setclipboard(data.DiscordLink or "")
      end
    end)
  end)

  return frame
end

local function AddImageLabel(parent, data)
  local frame = Create("Frame", parent, {
    BackgroundColor3 = Configs_HUB.Cor_Hub,
    Size = UDim2.new(1, 0, 0, 140)
  })
  Corner(frame)

  local img = Create("ImageLabel", frame, {
    Image = data.Image or "",
    Size = UDim2.new(1, -20, 1, -20),
    Position = UDim2.new(0, 10, 0, 10),
    BackgroundTransparency = 1,
    ScaleType = Enum.ScaleType.Fit,
    ClipsDescendants = true
  })

  return frame
end

local function AddSection(parent, texts)
  local label = Create("TextLabel", parent, {
    Text = texts[1] or "القسم",
    Font = Configs_HUB.Text_Font,
    TextSize = 22,
    TextColor3 = Configs_HUB.Cor_DarkText,
    BackgroundTransparency = 1,
    Size = UDim2.new(1, 0, 0, 35),
    TextXAlignment = Enum.TextXAlignment.Left
  })
  return label
end

local function AddButton(parent, data)
  local btn = Create("TextButton", parent, {
    Text = data.Name or "زر",
    Font = Configs_HUB.Text_Font,
    TextSize = 18,
    TextColor3 = Configs_HUB.Cor_DarkText,
    BackgroundColor3 = Configs_HUB.Cor_Options,
    Size = UDim2.new(1, 0, 0, 45),
    AutoButtonColor = true
  })
  Corner(btn)
  Stroke(btn)

  btn.MouseButton1Click:Connect(function()
    if data.Callback then
      data.Callback()
    end
  end)

  return btn
end

local function MinimizeButton(data)
  local btn = Create("ImageButton", ScreenGui, {
    Image = data.Image or "",
    Size = UDim2.new(0, data.Size[1] or 40, 0, data.Size[2] or 40),
    BackgroundColor3 = data.Color or Configs_HUB.Cor_Hub,
    Position = UDim2.new(0, 20, 0, 20),
    AutoButtonColor = true
  })
  if data.Corner then Corner(btn) end
  if data.Stroke then Stroke(btn) end
  btn.ZIndex = 10

  local minimized = false
  btn.MouseButton1Click:Connect(function()
    minimized = not minimized
    Window.Visible = not minimized
    if minimized then
      Tween(Window, "Size", UDim2.new(0, 0, 0, 0), 0.25)
    else
      Tween(Window, "Size", UDim2.new(0, 600, 0, 380), 0.25)
    end
  end)
  return btn
end

-- هذا الجدول يربط الوظائف معاً --
return {
  MakeWindow = function(configs) end, -- (للمطابقة فقط)

  MakeTab = MakeTab,

  AddParagraph = AddParagraph,
  AddDiscord = AddDiscord,
  AddImageLabel = AddImageLabel,
  AddSection = AddSection,
  AddButton = AddButton,
  MinimizeButton = MinimizeButton
}
